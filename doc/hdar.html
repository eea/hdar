<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>A Guide to hdar package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A Guide to hdar package</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#accessing-the-hda-service" id="toc-accessing-the-hda-service">Accessing the HDA Service</a></li>
<li><a href="#setup" id="toc-setup">Setup</a></li>
<li><a href="#authentication" id="toc-authentication">Authentication</a>
<ul>
<li><a href="#creating-and-authenticating-the-client" id="toc-creating-and-authenticating-the-client">Creating and
Authenticating the Client</a></li>
<li><a href="#checking-authentication" id="toc-checking-authentication">Checking Authentication</a></li>
</ul></li>
<li><a href="#finding-datasets" id="toc-finding-datasets">Finding
Datasets</a>
<ul>
<li><a href="#basic-usage" id="toc-basic-usage">Basic Usage</a></li>
<li><a href="#filtering-datasets" id="toc-filtering-datasets">Filtering
Datasets</a></li>
<li><a href="#understanding-the-results" id="toc-understanding-the-results">Understanding the Results</a></li>
</ul></li>
<li><a href="#creating-a-query-template" id="toc-creating-a-query-template">Creating a Query Template</a>
<ul>
<li><a href="#basic-usage-1" id="toc-basic-usage-1">Basic Usage</a></li>
<li><a href="#modify-and-use-the-generated-query-template" id="toc-modify-and-use-the-generated-query-template">Modify and use the
generated Query Template</a></li>
</ul></li>
<li><a href="#searching-and-downloading-data" id="toc-searching-and-downloading-data">Searching and Downloading
Data</a>
<ul>
<li><a href="#searching-for-data" id="toc-searching-for-data">Searching
for Data</a></li>
<li><a href="#downloading-the-files" id="toc-downloading-the-files">Downloading the files</a></li>
</ul></li>
</ul>
</div>

<div id="important-notice" class="section level3">
<h3>Important Notice</h3>
<div style="border: 1px solid orange; padding: 10px; background-color: #fff3cd; color: #856404;">
<p><strong>Notice:</strong> We are currently performing maintenance and
improvements on the Backend service. You may experience intermittent
slow responses or minor issues. Rest assured, our team is working hard
to enhance your experience. Thank you for your patience!</p>
</div>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>hdar</code> R package provides seamless access to the WEkEO
Harmonised Data Access (HDA) API, enabling users to efficiently query,
download, and process data from the HDA platform.</p>
</div>
<div id="accessing-the-hda-service" class="section level1">
<h1>Accessing the HDA Service</h1>
<p>To utilize the HDA service and library, you must first register for a
WEkEO account. The HDA service is available at no cost to all WEkEO
users. Creating an account allows you full access to our services,
ensuring you can leverage the full capabilities of HDA seamlessly.
Registration is straightforward and can be completed through the
following link: <a href="https://www.wekeo.eu/register">Register for
WEkEO</a>. Once your account is set up, you will be able to access the
HDA services immediately.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>To start using the <code>hdar</code> package, you first need to
install and load it in your R environment.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Install hdar from CRAN (if available) or GitHub</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># install.packages(&quot;hdar&quot;)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;eea/hdar@develop&quot;)</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co"># Load the hdar package</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(hdar)</span></code></pre></div>
</div>
<div id="authentication" class="section level1">
<h1>Authentication</h1>
<p>To interact with the HDA service, you need to authenticate by
providing your username and password. The <code>Client</code> class
allows you to pass these credentials directly and optionally save them
to a configuration file for future use. If credentials are not specified
as parameters, the client will read them from the <code>~/.hdarc</code>
file.</p>
<div id="creating-and-authenticating-the-client" class="section level2">
<h2>Creating and Authenticating the Client</h2>
<p>You can create an instance of the <code>Client</code> class by
passing your username and password directly. TThe initialization method
has an optional parameter <code>save_credentials</code> that specifies
whether the provided credentials should be saved in the
<code>~/.hdarc</code> configuration file. By default,
<code>save_credential</code>s is set to <code>FALSE</code>.</p>
<div id="example-pass-userpassword-at-initialization" class="section level3">
<h3>Example: Pass User/Password at Initialization</h3>
<p>Here is an example of how to authenticate by passing the user and
password, and optionally saving these credentials:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Define your username and password</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>username <span class="ot">&lt;-</span> <span class="st">&quot;your_username&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>password <span class="ot">&lt;-</span> <span class="st">&quot;your_password&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Create an instance of the Client class and save credentials to a config file</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># The save_credentials parameter is optional and defaults to FALSE</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>client <span class="ot">&lt;-</span> Client<span class="sc">$</span><span class="fu">new</span>(username, password, <span class="at">save_credentials =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>If the <code>save_credentials</code> parameter is set to
<code>TRUE</code>, the credentials will be saved in the
<code>~/.hdarc</code> file, making it easier to authenticate in future
sessions without passing the credentials again.</p>
</div>
<div id="example-using-saved-credentials" class="section level3">
<h3>Example: Using Saved Credentials</h3>
<p>Once the credentials are saved, you can initialize the Client class
without passing the credentials. The client will read the credentials
from the <code>~/.hdarc</code> file:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Create an instance of the Client class without passing credentials</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>client <span class="ot">&lt;-</span> Client<span class="sc">$</span><span class="fu">new</span>()</span></code></pre></div>
</div>
</div>
<div id="checking-authentication" class="section level2">
<h2>Checking Authentication</h2>
<p>Once the client is created, you can check if it has been
authenticated properly by calling a method <code>token()</code> that
verifies authentication. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Example method to check authentication by getting the auth token</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>client<span class="sc">$</span><span class="fu">get_token</span>()</span></code></pre></div>
<p>By using one of these methods, you can securely authenticate with the
HDA service and start making requests.</p>
</div>
</div>
<div id="finding-datasets" class="section level1">
<h1>Finding Datasets</h1>
<p>To interact with the HDA service, you will often need to find
datasets available on WEkEO. The Client class provides a method called
<code>datasets</code> that lists available datasets, optionally filtered
by a text pattern.</p>
<div id="basic-usage" class="section level2">
<h2>Basic Usage</h2>
<p>The basic usage of the datasets method is straightforward. You can
retrieve a list of all datasets available on WEkEO by calling the
<code>datasets</code> method on an instance of the <code>Client</code>
class.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Assuming &#39;client&#39; is already created and authenticated</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># client &lt;- Client$new()</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>all_datasets <span class="ot">&lt;-</span> client<span class="sc">$</span><span class="fu">datasets</span>()</span></code></pre></div>
</div>
<div id="filtering-datasets" class="section level2">
<h2>Filtering Datasets</h2>
<p>You can also filter the datasets by providing a text pattern. This is
useful when you are looking for datasets that match a specific keyword
or phrase.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Assuming &#39;client&#39; is already created and authenticated</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co"># client &lt;- Client$new()</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;Seasonal Trajectories&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co"># client &lt;- Client$new()</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;Seasonal Trajectories&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>filtered_datasets <span class="ot">&lt;-</span> client<span class="sc">$</span><span class="fu">datasets</span>(pattern)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># list dataset IDs</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">sapply</span>(filtered_datasets,<span class="at">FUN =</span> <span class="cf">function</span>(x){x<span class="sc">$</span>dataset_id})</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_VPP-LAEA&quot;</span> <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_ST&quot;</span>     </span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>[<span class="dv">3</span>] <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_ST-LAEA&quot;</span> <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_VPP&quot;</span></span></code></pre></div>
</div>
<div id="understanding-the-results" class="section level2">
<h2>Understanding the Results</h2>
<p>The datasets method returns a list containing datasets and associated
information. This information may include dataset names, descriptions,
and other metadata.</p>
</div>
</div>
<div id="creating-a-query-template" class="section level1">
<h1>Creating a Query Template</h1>
<p>To search for data in the HDA service, you need to create a query
template. Manually creating a query template can be tedious as it
involves reading documentation and learning about possible parameters.
To simplify this process, the <code>generate_query_template</code>
function is provided to automate the creation of query templates for a
given dataset.</p>
<div id="basic-usage-1" class="section level2">
<h2>Basic Usage</h2>
<p>The <code>generate_query_template</code> function generates a
template of a query for a specified dataset. This function fetches
information about existing parameters, default values, etc., from the
<code>/queryable</code> endpoint of the HDA service. The
<code>generate_query_template</code> function generates a template of a
query for a specified dataset. This function fetches information about
existing parameters, default values, etc., from the
<code>/queryable</code> endpoint of the HDA service.</p>
<div id="example-generating-a-query" class="section level4">
<h4>Example: Generating a Query</h4>
<p>Here is an example of how to generate a query template for the
dataset with the ID “EO:EEA:DAT:CLMS_HRVPP_ST”:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># client &lt;- Client$new()</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>query_template <span class="ot">&lt;-</span> client<span class="sc">$</span><span class="fu">generate_query_template</span>(<span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_ST&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>query_template</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>{</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="st">&quot;dataset_id&quot;</span><span class="sc">:</span> <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_ST&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="st">&quot;uid&quot;</span><span class="sc">:</span> <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="st">&quot;productType&quot;</span><span class="sc">:</span> <span class="st">&quot;PPI&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="st">&quot;platformSerialIdentifier&quot;</span><span class="sc">:</span> <span class="st">&quot;S2A, S2B&quot;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="st">&quot;tileId&quot;</span><span class="sc">:</span> <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="st">&quot;productVersion&quot;</span><span class="sc">:</span> <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span>,</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="st">&quot;resolution&quot;</span><span class="sc">:</span> <span class="st">&quot;10&quot;</span>,</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="st">&quot;processingDate&quot;</span><span class="sc">:</span> <span class="st">&quot;__### Value of string&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  <span class="st">&quot;start&quot;</span><span class="sc">:</span> <span class="st">&quot;__### Value of string&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  <span class="st">&quot;end&quot;</span><span class="sc">:</span> <span class="st">&quot;__### Value of string&quot;</span>,</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>  <span class="st">&quot;bbox&quot;</span><span class="sc">:</span> [</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">180</span>,</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">90</span>,</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>    <span class="dv">180</span>,</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>    <span class="dv">90</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>  ]</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="modify-and-use-the-generated-query-template" class="section level2">
<h2>Modify and use the generated Query Template</h2>
<p>You can and should customize the generated query template to fit your
specific needs. Fields starting with <code>__###</code> are placeholders
indicating possible values. If these placeholders are left unchanged,
they will be automatically removed before sending the query to the HDA
service.</p>
<p>To modify the query, it is often easier to transform the JSON into an
R list using the <code>jsonlite::fromJSON()</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># convert to list for easier manipulation in R</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>query_template <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(query_template)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>query_template</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="sc">$</span>dataset_id</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_ST&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="sc">$</span>uid</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="sc">$</span>productType</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;PPI&quot;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="sc">$</span>platformSerialIdentifier</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;S2A, S2B&quot;</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="sc">$</span>tileId</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="sc">$</span>productVersion</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="sc">$</span>resolution</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;10&quot;</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="sc">$</span>processingDate</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string&quot;</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="sc">$</span>start</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string&quot;</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="sc">$</span>end</span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string&quot;</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="sc">$</span>bbox</span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="dv">180</span>  <span class="sc">-</span><span class="dv">90</span>  <span class="dv">180</span>   <span class="dv">90</span></span></code></pre></div>
<p>Here is an example of how to use the query template in a search:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># set a new bbox</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>query_template<span class="sc">$</span>bbox <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.1090</span>, <span class="fl">46.6210</span>, <span class="fl">11.2090</span>, <span class="fl">46.7210</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># limit the time range</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>query_template<span class="sc">$</span>start <span class="ot">&lt;-</span> <span class="st">&quot;2018-03-01T00:00:00.000Z&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>query_template<span class="sc">$</span>end   <span class="ot">&lt;-</span> <span class="st">&quot;2018-05-31T00:00:00.000Z&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>query_template</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="sc">$</span>dataset_id</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;EO:EEA:DAT:CLMS_HRVPP_ST&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="sc">$</span>uid</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="sc">$</span>productType</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;PPI&quot;</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="sc">$</span>platformSerialIdentifier</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;S2A, S2B&quot;</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="sc">$</span>tileId</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="sc">$</span>productVersion</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string type with pattern: [</span><span class="sc">\\</span><span class="st">w-]+&quot;</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="sc">$</span>resolution</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;10&quot;</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="sc">$</span>processingDate</span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;__### Value of string&quot;</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="sc">$</span>start</span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2018-03-01T00:00:00.000Z&quot;</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="sc">$</span>end</span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;2018-05-31T00:00:00.000Z&quot;</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="sc">$</span>bbox</span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">11.109</span> <span class="fl">46.621</span> <span class="fl">11.209</span> <span class="fl">46.721</span></span></code></pre></div>
<p>Once you have made the necessary modifications, you can convert the
list back to JSON format with the <code>jsonlite::toJSON()</code>
function. It’s crucial to use the <code>auto_unbox = TRUE</code> flag
when converting back to JSON. This ensures that the JSON is correctly
formatted, particularly for arrays with a single element, due to the way
<code>jsonlite</code> handles serialization.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># convert to JSON format</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>query_template <span class="ot">&lt;-</span> <span class="fu">toJSON</span>(query_template, <span class="at">auto_unbox =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>
<div id="searching-and-downloading-data" class="section level1">
<h1>Searching and Downloading Data</h1>
<p>To search for data in the HDA service, you can use the
<code>search</code> function provided by the Client class. This function
allows you to search for datasets based on a query and optionally limit
the number of results. The search results can then be downloaded using
the download method of the <code>SearchResults</code> class.</p>
<div id="searching-for-data" class="section level2">
<h2>Searching for Data</h2>
<p>The <code>search</code> function takes a query and an optional limit
parameter, which specifies the maximum number of results you want to
retrieve. The function only searches for data and does not download it.
The output of this function is an instance of the
<code>SearchResults</code> class.</p>
<p>Here is an example of how to search for data using a query and limit
the results to 5:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Assuming &#39;client&#39; is already created and authenticated, &#39;query&#39; is defined</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>matches <span class="ot">&lt;-</span> client<span class="sc">$</span><span class="fu">search</span>(query_template)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Found 9 files&quot;</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Total Size 1.8 GB&quot;</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">sapply</span>(matches<span class="sc">$</span>results,<span class="at">FUN =</span> <span class="cf">function</span>(x){x<span class="sc">$</span>id})</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;ST_20180301T000000_S2_T32TPS-010m_V101_PPI&quot;</span> <span class="st">&quot;ST_20180311T000000_S2_T32TPS-010m_V101_PPI&quot;</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>[<span class="dv">3</span>] <span class="st">&quot;ST_20180321T000000_S2_T32TPS-010m_V101_PPI&quot;</span> <span class="st">&quot;ST_20180401T000000_S2_T32TPS-010m_V101_PPI&quot;</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>[<span class="dv">5</span>] <span class="st">&quot;ST_20180411T000000_S2_T32TPS-010m_V101_PPI&quot;</span> <span class="st">&quot;ST_20180421T000000_S2_T32TPS-010m_V101_PPI&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>[<span class="dv">7</span>] <span class="st">&quot;ST_20180501T000000_S2_T32TPS-010m_V101_PPI&quot;</span> <span class="st">&quot;ST_20180511T000000_S2_T32TPS-010m_V101_PPI&quot;</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>[<span class="dv">9</span>] <span class="st">&quot;ST_20180521T000000_S2_T32TPS-010m_V101_PPI&quot;</span></span></code></pre></div>
</div>
<div id="downloading-the-files" class="section level2">
<h2>Downloading the files</h2>
<p>The <code>SearchResults</code> class has a public field
<code>results</code> and a method called <code>download</code> that is
responsible for downloading the found data. The <code>download()</code>
function takes an output directory (which is created if it doesn’t
already exist) and includes an optional <code>force</code> parameter.
When <code>force</code> is set to <code>TRUE</code>, the function will
re-download the files even if they already exist in the output
directory, overwriting the existing files. If <code>force</code> is set
to <code>FALSE</code> (the default), the function will skip downloading
files that already exist, saving time and bandwidth.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Assuming &#39;matches&#39; is an instance of SearchResults obtained from the search</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>odir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>matches<span class="sc">$</span><span class="fu">download</span>(odir)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>The total size is <span class="fl">1.8</span> GB . Do you want to proceed? (Y<span class="sc">/</span>N)<span class="sc">:</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>y</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Start&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 1/9&quot;</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 2/9&quot;</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 3/9&quot;</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 4/9&quot;</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 5/9&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 6/9&quot;</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 7/9&quot;</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 8/9&quot;</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] Downloading file 9/9&quot;</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;[Download] DONE&quot;</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co"># Assuming &#39;matches&#39; is an instance of SearchResults obtained from the search</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="fu">list.files</span>(odir)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;ST_20180301T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span> <span class="st">&quot;ST_20180311T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>[<span class="dv">3</span>] <span class="st">&quot;ST_20180321T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span> <span class="st">&quot;ST_20180401T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>[<span class="dv">5</span>] <span class="st">&quot;ST_20180411T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span> <span class="st">&quot;ST_20180421T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>[<span class="dv">7</span>] <span class="st">&quot;ST_20180501T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span> <span class="st">&quot;ST_20180511T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>[<span class="dv">9</span>] <span class="st">&quot;ST_20180521T000000_S2_T32TPS-010m_V101_PPI.tif&quot;</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="fu">unlink</span>(odir,<span class="at">recursive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
